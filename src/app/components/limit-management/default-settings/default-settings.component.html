<div class="wrapper">

    <!-- Page Content  -->
    <div id="content" class="bg-light  right_col">
        <div class="container pl-30 pr-30" *ngIf="enterData">
            <h2 class="">Limit Management - Default Settings</h2>
            <div class="dash-line"></div>
            <p class="text-right pt-3"><span class="red">*</span> All Fields are mandatory</p>
            <div class="shadow1 mt-4 pt-4 pb-5 pl-30 pr-30">
                <h5 class="text-color pt-2">Limit Definition</h5>
                <hr>
                <form [formGroup]="defaultLimitManagement" (ngSubmit)="confirmLimit()">
                    <div class="row mb-3 mt-4">
                        <div class="col-md-2 col-sm-12">
                            <div class="">
                                <label class="select-label1">Limit Code <span class="red">*</span></label>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <div class="">
                                <input type="text" formControlName='limitCode' name="limitCode" (input)="isInput()" maxlength="6" class="form-control br" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('limitCode').errors}" />
                                <div *ngIf="submitted && defaultLimitManagement.get('limitCode').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('limitCode').errors.required ">Limit Code should not be empty.</div>
                                    <div *ngIf="defaultLimitManagement.get('limitCode').errors.pattern ">Do not use special character (@!#$%^&*()).</div>
                                    <div *ngIf="defaultLimitManagement.get('limitCode').errors.maxlength || defaultLimitManagement.get('limitCode').errors.minlength">Length must be between 6 char.</div>
                                </div>
                                <div *ngIf="isExistGroup" style="color: red">
                                    Limit code already exist.
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-12">
                            <div class="">
                                <label class="select-label1">Limit Name <span class="red">*</span></label>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <div class="">
                                <input type="text" formControlName='limitName' class="form-control br" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('limitName').errors}" />
                                <div *ngIf="submitted && defaultLimitManagement.get('limitName').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('limitName').errors.required ">Group Name should not be empty.</div>
                                    <div *ngIf="defaultLimitManagement.get('limitName').errors.pattern ">Do not use special character (@!#$%^&*()).</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <h5 class="text-color pt-2 mt-5">Default Limit Settings</h5>
                    <hr>

                    <div class="row">
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label">Transaction <span class="red">*</span></label>
                                <select class="form-control br" formControlName="transaction" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('transaction').errors}">
                                    <option value="">Select</option>
                                    <option *ngFor="let dataTrx of transactionData">{{dataTrx.transaction}}</option>
                                </select>
                                <div *ngIf="submitted && defaultLimitManagement.get('transaction').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('transaction').errors.required ">Transaction should not be empty.</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label">Frequency <span class="red">*</span></label>
                                <select class="form-control br" formControlName="frequency" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('frequency').errors}">
                                    <option value="">Select</option>
                                    <option value="Per Txn">Per Txn</option>
                                    <option value="Daily">Daily</option>
                                    <option vakue="Weekly">Weekly</option>
                                    <option vakue="Monthly">Monthly</option>
                                    <option vakue="Yearly">Yearly</option>
                                    <option vakue="Life Time">Life Time</option>
                                </select>
                                <div *ngIf="submitted && defaultLimitManagement.get('frequency').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('frequency').errors.required ">Frequency should not be empty.</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label">Level Check <span class="red">*</span></label>
                                <select class="form-control br" formControlName="levelCheck" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('levelCheck').errors}">
                                    <option value="">Select</option>
                                    <option value="Account">Account</option>
                                    <option value="Card">Card</option>
                                    <option value="Customer">Customer</option>
                                </select>
                                <div *ngIf="submitted && defaultLimitManagement.get('levelCheck').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('levelCheck').errors.required ">Level Check should not be empty.</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label">Maximum Count <span class="red">*</span></label>
                                <input type="number" class="form-control br" formControlName="maxCount" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('maxCount').errors}" />
                                <div *ngIf="submitted && defaultLimitManagement.get('maxCount').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('maxCount').errors.required ">Maximum count should not be empty.</div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label1">Currency <span class="red">*</span></label>
                                <select class="form-control br" formControlName="currencyType" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('currencyType').errors}">
                                    <option value="">Select</option>
                                    <option *ngFor="let currency of currencyData">{{currency.cmsBinCurrency}}</option>
                                </select>
                                <div *ngIf="submitted && defaultLimitManagement.get('currencyType').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('currencyType').errors.required ">Currency should not be empty.</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label1">Minimum Amount <span class="red">*</span></label>
                                <input type="number" class="form-control br" formControlName="minAmt" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('minAmt').errors}" />
                                <div *ngIf="submitted && defaultLimitManagement.get('minAmt').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('minAmt').errors.required ">Minimum Amount should not be empty.</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-12">
                            <div class="form-group mb-4">
                                <label class="select-label">Maximum Amount <span class="red">*</span></label>
                                <input type="number" class="form-control br" formControlName="maxAmt" [ngClass]="{ 'is-invalid':submitted && defaultLimitManagement.get('maxAmt').errors}" />
                                <div *ngIf="submitted && defaultLimitManagement.get('maxAmt').errors " class="invalid-feedback ">
                                    <div *ngIf="defaultLimitManagement.get('maxAmt').errors.required ">Maximum Amount should not be empty.</div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="col-md-12 text-center mt-5">
                        <input type="button" class="btn btn1 shadow1 btnSubmit bg-color text-white" value="Add" (click)="add()" />
                    </div>

                    <div class="table-responsive mt-5">
                        <table class="table table-striped table-bordered table-hover text-center">
                            <thead class="thead-dark bg-color text-white">
                                <tr>
                                    <th scope="col">Limit Code</th>
                                    <th scope="col">Transaction</th>
                                    <th scope="col">Frequency</th>
                                    <th scope="col">Level Check</th>
                                    <th scope="col">Maximum Count</th>
                                    <th scope="col">Currency</th>
                                    <th scope="col">Minimum Amount</th>
                                    <th scope="col">Maximum Amount</th>
                                    <th>Remove</th>
                                </tr>
                            </thead>
                            <tbody formArrayName='limitTable' *ngFor="let r of defaultLimitManagement.get('limitTable').controls; index as i ">
                                <tr [formGroupName]="i">
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='limitCode' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='transaction' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='frequency' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='levelCheck' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='maxCount' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='currencyType' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='minAmt' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="text" class="text-center" formControlName='maxAmt' style="border: none; padding :0; margin:0;background-color: transparent;" readonly></td>
                                    <td style="padding :10px; margin:0;"><input type="button" value="remove" (click)="remove(i)"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-12 text-center mt-5">
                        <input type="button" class="btn btn1 shadow1 btnSubmit bg-color text-white" value="Cancel" (input)="cancel()" />
                        <input type="submit" class="btn btn1 shadow1 btnSubmit bg-color text-white ml-2" value="Submit" />
                    </div>
                </form>
            </div>
        </div>

        <!-- Confirm Default setting -->

        <div class="container pl-30 pr-30" *ngIf="confirm">
            <h2 class="">Usage Settings - View Default Settings-Confirm</h2>
            <div class="dash-line"></div>

            <div class="shadow1 mt-5 pt-4 pb-5 pl-30 pr-30">
                <h5 class="text-color pt-2">Limit Definition</h5>
                <hr>
                <form>
                    <div *ngFor="let data of confirmForm.limitTable; index as i">
                        <div class="table-responsive">

                            <table class="table table-borderless">
                                <tr>
                                    <td class="font-weight-bold">Limit Code</td>
                                    <td>{{data.limitCode}}</td>
                                    <td class="font-weight-bold">Limit Name</td>
                                    <td>{{data.limitName}}</td>
                                </tr>
                            </table>
                        </div>
                        <h5 class="text-color pt-2">Default Limit Settings</h5>
                        <hr>
                        <div class="table-responsive mt-5">
                            <table class="table table-striped table-bordered table-hover text-center">
                                <thead class="thead-dark bg-color text-white">
                                    <tr>
                                        <th scope="col">Transaction</th>
                                        <th scope="col">Frequency</th>
                                        <th scope="col">Level Check</th>
                                        <th scope="col">Maximum Count</th>
                                        <th scope="col">Currency</th>
                                        <th scope="col">Minimum Amount</th>
                                        <th scope="col">Maximum Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>{{data.transaction}}</td>
                                        <td>{{data.frequency}}</td>
                                        <td>{{data.levelCheck}}</td>
                                        <td>{{data.maxCount}}</td>
                                        <td>{{data.currencyType}}</td>
                                        <td>{{data.minAmt}}</td>
                                        <td>{{data.maxAmt}}</td>
                                    </tr>
                                </tbody>
                                <hr style="border:1px solid gray;">
                            </table>
                        </div>
                    </div>

                    <div class=" row col-md-12 text-center mt-5">
                        <input type="button" class="btn btn1 shadow1 btnSubmit bg-color text-white" value="Cancel" (click)="cancel()" />
                        <input type="submit" class="btn btn1 shadow1 btnSubmit bg-color text-white ml-2" value="Confirm" (click)="save()" />
                    </div>


                </form>
            </div>
        </div>


    </div>
</div>


<div class="modal" id="success" role="dialog">
    <div class="modal-dialog modal-dialog-centered">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header bg-info">
                <h4 class="text-light">Success</h4>
                <button type="button" class="close" (click)="close()" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <h5>{{success}}</h5>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-info" data-dismiss="modal" (click)="close()">Close</button>
            </div>
        </div>

    </div>
</div>

<div class="modal" id="error" role="dialog">
    <div class="modal-dialog modal-dialog-centered">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header bg-danger">
                <h3 class="text-light">Error</h3>
                <button type="button" class="close" (click)="close()" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <h4>{{success}}</h4>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="close()">Close</button>
            </div>
        </div>

    </div>
</div>